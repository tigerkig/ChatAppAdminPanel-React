{"ast":null,"code":"var _jsxFileName = \"E:\\\\dev\\\\admin_panel\\\\LocalsAdminPanel\\\\src\\\\contexts\\\\JWTContext.js\";\nimport { createContext, useEffect, useReducer } from 'react';\nimport PropTypes from 'prop-types'; // utils\n\nimport axios from '../utils/axios';\nimport { isValidToken, setSession } from '../utils/jwt'; // ----------------------------------------------------------------------\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst initialState = {\n  isAuthenticated: false,\n  isInitialized: false,\n  user: null\n};\nconst handlers = {\n  INITIALIZE: (state, action) => {\n    const {\n      isAuthenticated,\n      user\n    } = action.payload;\n    return { ...state,\n      isAuthenticated,\n      isInitialized: true,\n      user\n    };\n  },\n  LOGIN: (state, action) => {\n    const {\n      user\n    } = action.payload;\n    return { ...state,\n      isAuthenticated: true,\n      user\n    };\n  },\n  LOGOUT: (state, action) => ({ ...state,\n    isAuthenticated: false,\n    user: null\n  }),\n  REGISTER: (state, action) => {\n    const {\n      user\n    } = action.payload;\n    return { ...state,\n      isAuthenticated: true,\n      user\n    };\n  }\n};\n\nconst reducer = (state, action) => handlers[action.type] ? handlers[action.type](state, action) : state;\n\nconst AuthContext = /*#__PURE__*/createContext({ ...initialState,\n  method: 'jwt',\n  login: () => Promise.resolve(),\n  logout: () => Promise.resolve(),\n  register: () => Promise.resolve()\n});\nAuthProvider.propTypes = {\n  children: PropTypes.node\n};\n\nfunction AuthProvider({\n  children\n}) {\n  const [state, dispatch] = useReducer(reducer, initialState);\n  useEffect(() => {\n    const initialize = async () => {\n      try {\n        const accessToken = window.localStorage.getItem('accessToken');\n\n        if (accessToken && isValidToken(accessToken)) {\n          setSession(accessToken);\n          const response = await axios.get('/auth/me', {\n            headers: {\n              Authorization: `Bearer ${accessToken}`\n            }\n          });\n          const {\n            user\n          } = response.data;\n          dispatch({\n            type: 'INITIALIZE',\n            payload: {\n              isAuthenticated: true,\n              user\n            }\n          });\n        } else {\n          dispatch({\n            type: 'INITIALIZE',\n            payload: {\n              isAuthenticated: false,\n              user: null\n            }\n          });\n        }\n      } catch (err) {\n        console.error(err);\n        dispatch({\n          type: 'INITIALIZE',\n          payload: {\n            isAuthenticated: false,\n            user: null\n          }\n        });\n      }\n    };\n\n    initialize();\n  }, []);\n\n  const login = async (email, password) => {\n    const response = await axios.post('/auth/adminlogin', {\n      email,\n      password\n    });\n\n    if (response.data.success) {\n      const {\n        accessToken,\n        user\n      } = response.data;\n      setSession(accessToken);\n      dispatch({\n        type: 'LOGIN',\n        payload: {\n          user\n        }\n      });\n    } else {\n      dispatch({\n        type: 'INITIALIZE',\n        payload: {\n          isAuthenticated: false,\n          user: null\n        }\n      });\n    }\n  };\n\n  const register = async (email, password, firstName, lastName) => {\n    const response = await axios.post('/api/account/register', {\n      email,\n      password,\n      firstName,\n      lastName\n    });\n    const {\n      accessToken,\n      user\n    } = response.data;\n    window.localStorage.setItem('accessToken', accessToken);\n    dispatch({\n      type: 'REGISTER',\n      payload: {\n        user\n      }\n    });\n  };\n\n  const logout = async () => {\n    const {\n      user\n    } = action.payload;\n    await axios.post(`/auth/logout/${user.email}`);\n    setSession(null);\n    dispatch({\n      type: 'LOGOUT'\n    });\n  };\n\n  const resetPassword = () => {};\n\n  const updateProfile = () => {};\n\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: { ...state,\n      method: 'jwt',\n      login,\n      logout,\n      register,\n      resetPassword,\n      updateProfile\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 170,\n    columnNumber: 5\n  }, this);\n}\n\nexport { AuthContext, AuthProvider };","map":{"version":3,"sources":["E:/dev/admin_panel/LocalsAdminPanel/src/contexts/JWTContext.js"],"names":["createContext","useEffect","useReducer","PropTypes","axios","isValidToken","setSession","initialState","isAuthenticated","isInitialized","user","handlers","INITIALIZE","state","action","payload","LOGIN","LOGOUT","REGISTER","reducer","type","AuthContext","method","login","Promise","resolve","logout","register","AuthProvider","propTypes","children","node","dispatch","initialize","accessToken","window","localStorage","getItem","response","get","headers","Authorization","data","err","console","error","email","password","post","success","firstName","lastName","setItem","resetPassword","updateProfile"],"mappings":"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","sourcesContent":["import { createContext, useEffect, useReducer } from 'react';\nimport PropTypes from 'prop-types';\n// utils\nimport axios from '../utils/axios';\nimport { isValidToken, setSession } from '../utils/jwt';\n\n// ----------------------------------------------------------------------\n\nconst initialState = {\n  isAuthenticated: false,\n  isInitialized: false,\n  user: null\n};\n\nconst handlers = {\n  INITIALIZE: (state, action) => {\n    const { isAuthenticated, user } = action.payload;\n    return {\n      ...state,\n      isAuthenticated,\n      isInitialized: true,\n      user\n    };\n  },\n  LOGIN: (state, action) => {\n    const { user } = action.payload;\n\n    return {\n      ...state,\n      isAuthenticated: true,\n      user\n    };\n  },\n  LOGOUT: (state, action) => ({\n    ...state,\n    isAuthenticated: false,\n    user: null\n  }),\n  REGISTER: (state, action) => {\n    const { user } = action.payload;\n\n    return {\n      ...state,\n      isAuthenticated: true,\n      user\n    };\n  }\n};\n\nconst reducer = (state, action) => (handlers[action.type] ? handlers[action.type](state, action) : state);\n\nconst AuthContext = createContext({\n  ...initialState,\n  method: 'jwt',\n  login: () => Promise.resolve(),\n  logout: () => Promise.resolve(),\n  register: () => Promise.resolve()\n});\n\nAuthProvider.propTypes = {\n  children: PropTypes.node\n};\n\nfunction AuthProvider({ children }) {\n  const [state, dispatch] = useReducer(reducer, initialState);\n\n  useEffect(() => {\n    const initialize = async () => {\n      try {\n        const accessToken = window.localStorage.getItem('accessToken');\n\n        if (accessToken && isValidToken(accessToken)) {\n          setSession(accessToken);\n\n          const response = await axios.get('/auth/me', {\n            headers: {\n              Authorization: `Bearer ${accessToken}`\n            }\n          });\n          const { user } = response.data;\n\n          dispatch({\n            type: 'INITIALIZE',\n            payload: {\n              isAuthenticated: true,\n              user\n            }\n          });\n        } else {\n          dispatch({\n            type: 'INITIALIZE',\n            payload: {\n              isAuthenticated: false,\n              user: null\n            }\n          });\n        }\n      } catch (err) {\n        console.error(err);\n        dispatch({\n          type: 'INITIALIZE',\n          payload: {\n            isAuthenticated: false,\n            user: null\n          }\n        });\n      }\n    };\n\n    initialize();\n  }, []);\n\n  const login = async (email, password) => {\n    const response = await axios.post('/auth/adminlogin', {\n      email,\n      password\n    });\n\n    if (response.data.success) {\n      const { accessToken, user } = response.data;\n\n      setSession(accessToken);\n      dispatch({\n        type: 'LOGIN',\n        payload: {\n          user\n        }\n      });\n    } else {\n      dispatch({\n        type: 'INITIALIZE',\n        payload: {\n          isAuthenticated: false,\n          user: null\n        }\n      });\n    }\n  };\n\n  const register = async (email, password, firstName, lastName) => {\n    const response = await axios.post('/api/account/register', {\n      email,\n      password,\n      firstName,\n      lastName\n    });\n    const { accessToken, user } = response.data;\n\n    window.localStorage.setItem('accessToken', accessToken);\n    dispatch({\n      type: 'REGISTER',\n      payload: {\n        user\n      }\n    });\n  };\n\n  const logout = async () => {\n    const { user } = action.payload;\n    await axios.post(`/auth/logout/${user.email}`);\n    setSession(null);\n    dispatch({ type: 'LOGOUT' });\n  };\n\n  const resetPassword = () => {};\n\n  const updateProfile = () => {};\n\n  return (\n    <AuthContext.Provider\n      value={{\n        ...state,\n        method: 'jwt',\n        login,\n        logout,\n        register,\n        resetPassword,\n        updateProfile\n      }}\n    >\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\nexport { AuthContext, AuthProvider };\n"]},"metadata":{},"sourceType":"module"}